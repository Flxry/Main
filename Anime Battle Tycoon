--Anti Afk
game:GetService("Players").LocalPlayer.Idled:Connect(function()
    game:GetService("VirtualUser"):ClickButton2(Vector2.new())
end)

--GetGenv

--Locals
local Player = game:GetService("Players").LocalPlayer
local Hrp = Player.Character.HumanoidRootPart
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Noti = game:GetService("Players").LocalPlayer.PlayerGui.Display.Notifications
local WorldTeleport = game:GetService("Workspace").Zones
local IsBoss = false;
local Vi = game:GetService("VirtualInputManager")

--For I, V
for i, v in pairs(game:GetService("Workspace").Tycoons:GetChildren()) do
    if v.Data.Owner.Value == Player then
        TycoonOwner = v
    end
end

--Tables
local MobList = {}
for i, v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
    if v:FindFirstChild("Units") and not table.find(MobList,"|-- "..v.Name.." --|") then
        table.insert(MobList,"|-- "..v.Name.." --|")
        for i2, v2 in pairs(v:GetDescendants()) do
            if v2.Name == "Name" and v2.Parent.Name == "Overhead" and v2.Parent.Parent.Name == "Head" and not table.find(MobList,v2.Text) then
                table.insert(MobList,v2.Text)
            end
        end
    end
end

local DummyList = {}
for i, v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
    if v:FindFirstChild("Dummies") and not table.find(DummyList,"|-- "..v.Name.." --|") then
        table.insert(DummyList,"|-- "..v.Name.." --|")
        for i2, v2 in pairs(v:GetDescendants()) do
            if v2.Name == "Name" and v2.Parent.Name == "Overhead" and v2.Parent.Parent.Name == "HumanoidRootPart" and not table.find(DummyList,v2.Text) then
                table.insert(DummyList,v2.Text)
            end
        end
    end
end

local ZoneList = {}
for i, v in pairs(game:GetService("Workspace").Zones:GetChildren()) do
    table.insert(ZoneList,v.Name)
end

local EggList = {}
for i, v in pairs(game:GetService("Workspace").Worlds:GetChildren()) do
    if v.ClassName == "Folder" and not table.find(EggList,"|-- "..v.Name.." --|") then
    table.insert(EggList,"|-- "..v.Name.." --|")
    for i2, v2 in pairs(v:GetDescendants()) do
        if v2.Name == "Prisms" then
            for i3, v3 in pairs(v2:GetChildren()) do
                if v3.ClassName == "Model" and not table.find(EggList,v3.ClassName) then
                        table.insert(EggList,v3.Name)
                    end
                end
            end
        end
    end
end

--Gui Locals
local Colors = {
    SchemeColor = Color3.fromRGB(163, 172, 255),
    Background = Color3.fromRGB(0, 0, 0),
    Header = Color3.fromRGB(0, 0, 0),
    TextColor = Color3.fromRGB(255, 255, 255),
    ElementColor = Color3.fromRGB(20, 20, 20)
}

local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("Anime Battle Tycoon", Colors)

--Tycoon
local Main = Window:NewTab("Main")
local Tycoon = Main:NewSection("Tycoon")

Tycoon:NewToggle("Auto Spawn", "Automatically Instant Spawns", function(v)
getgenv().AutoSpawn = v
    spawn(function()
        while task.wait() do
            if not AutoSpawn then break; end
                    pcall(function()
                    if IsBoss == false then
                    local Spawner = TycoonOwner.Tycoon.Objects[1].Spawners.Start.Model.Proximity.Attachment.TycoonSpawn
                    Hrp = Player.Character.HumanoidRootPart
                    Hrp.CFrame = Spawner.Parent.Parent.CFrame + Vector3.new(-5,1,0)
                    fireproximityprompt(Spawner)
                end
            end)
        end
    end)
end)

Tycoon:NewToggle("Auto Sell", "Automatically Collects Your Money", function(v)
    getgenv().AutoSell = v
    spawn(function()
        while wait() do
            if not AutoSell then break; end
            game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateTycoons:FireServer("CollectMoney")
        end
    end)
end)

Tycoon:NewToggle("Auto Buy Buttons", "Auto Buys The Tycoon Buttons", function(v)
        getgenv().AutoButton = v
        spawn(function()
        while wait() do
        if not AutoButton then break; end
        for i, v in pairs(TycoonOwner.Tycoon.Buttons:GetChildren()) do
                game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateTycoons:FireServer("BuyButton",v.Name)
            end
        end
    end)
end)

--Mob Farm
local Farming = Window:NewTab("Farming")
local MobFarm = Farming:NewSection("Mob Farm")
local BossFarm = Farming:NewSection("Boss Farm")
local DummyFarm = Farming:NewSection("Dummy Farm")
local QuestFarm = Farming:NewSection("Quest Farm")
local Other = Farming:NewSection("Other")

function MobTeleport()
    local Near = math.huge
    local TeleMob
    local Plr = Player.Character.HumanoidRootPart
    for i,v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
        if v:FindFirstChild("Units") then
            for i2,v2 in pairs(v.Units:GetChildren()) do
                if v2:FindFirstChild("Head") and v2.Head:FindFirstChild("Overhead") then
                    for i3,v3 in pairs(v2.Head.Overhead:GetChildren()) do
                        if v3.Name == "Name" and v3.Text == ChooseMob then
                            local Mag = (Plr.CFrame.p - v3.Parent.Parent.Parent.HumanoidRootPart.CFrame.p).Magnitude
                            if Mag < Near then
                            TeleMob = v3.Parent.Parent.Parent.HumanoidRootPart
                            Near = Mag
                            end
                        end
                    end
                end
            end
        end
    end
    return TeleMob
end

function Noclip()
    for i, v in pairs(Player.Character:GetDescendants()) do
        if v:IsA("BasePart") and v.CanCollide == true then
            v.CanCollide = false
        end
    end
    Player.Character.HumanoidRootPart.Velocity = Vector3.new(0,1,0)
end

game:GetService("RunService").Stepped:Connect(function()
    if getgenv().AutoMob then
        Noclip()
    end
end)

MobFarm:NewToggle("Start Mob Farm", "Starts The AutoFarm", function(v)
getgenv().AutoMob = v
    spawn(function()
        while wait() do
            if not AutoMob then break; end
            pcall(function()
                if IsBoss == false then
                Hrp = Player.Character.HumanoidRootPart
                Hrp.CFrame = MobTeleport().CFrame * CFrame.new(0,4,0) * CFrame.Angles((180),0,0)
                ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateMelee:FireServer("RequestAction","Combat","Combat")
                Noclip()
                end
            end)
        end
    end)
end)

MobFarm:NewDropdown("Choose Mob", "Choose The Mob To Farm", MobList, function(v)
    ChooseMob = v
end)

function BossTeleport()
    local Near = math.huge
    local TeleBoss
    local Plr = Player.Character.HumanoidRootPart
    for i, v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
        if v:FindFirstChild("Boss") then
            for i2, v2 in pairs(v.Boss:GetChildren()) do
                if (Plr.CFrame.p - v2.HumanoidRootPart.CFrame.p).Magnitude < Near then
                    TeleBoss = v2.HumanoidRootPart
                    Near = (Plr.CFrame.p - v2.HumanoidRootPart.CFrame.p).Magnitude
                    Noclip()
                end
            end
        end
    end
    return TeleBoss
end

BossFarm:NewToggle("Start Boss Farm", "Starts The Boss AutoFarm", function(v)
    getgenv().AutoBoss = v
        spawn(function()
            while wait() do
                if not AutoBoss then break; end
                pcall(function()
                if BossTeleport() ~= nil then
                IsBoss = true;
                Hrp = Player.Character.HumanoidRootPart
                Hrp.CFrame = BossTeleport().CFrame * CFrame.new(0,4,0) * CFrame.Angles((180),0,0)
                ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateMelee:FireServer("RequestAction","Combat","Combat")
            else
                IsBoss = false;
                end
            end)
        end
    end)
end)

function TimeTeleport()
    local Near = math.huge
    local TeleTime
    local Plr = Player.Character.HumanoidRootPart
    for i,v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
        if v:FindFirstChild("Dummies") then
            for i2,v2 in pairs(v.Dummies:GetChildren()) do
                if v2:FindFirstChild("HumanoidRootPart") and v2.HumanoidRootPart:FindFirstChild("Overhead") then
                    for i3,v3 in pairs(v2.HumanoidRootPart.Overhead:GetChildren()) do
                        if v3.Name == "Name" and v3.Text == ChooseDummy then
                            local Mag = (Plr.CFrame.p - v3.Parent.Parent.Parent.HumanoidRootPart.CFrame.p).Magnitude
                            if Mag < Near then
                            TeleTime = v3.Parent.Parent.Parent.HumanoidRootPart
                            Near = Mag
                            end
                        end
                    end
                end
            end
        end
    end
    return TeleTime
end

DummyFarm:NewToggle("Start Dummy Farm", "Starts The Dummy Farm Farm", function(v)
    getgenv().AutoDummy = v
        spawn(function()
            while wait() do
                if not AutoDummy then break; end
                pcall(function()
                    if IsBoss == false then
                    Hrp = Player.Character.HumanoidRootPart
                    Hrp.CFrame = TimeTeleport().CFrame * CFrame.new(0,4,0) * CFrame.Angles((180),0,0)
                    ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateMelee:FireServer("RequestAction","Combat","Combat")
                    Noclip()
                    end
                end)
            end
        end)
    end)

DummyFarm:NewDropdown("Choose Dummy", "Choose Dummy To Farm", DummyList, function(v)
    ChooseDummy = v
end)

function QuestTeleport()
    local Near = math.huge
    local TeleQuest
    local Plr = Player.Character.HumanoidRootPart
    local Quest = game.Players.LocalPlayer.PlayerGui.Display.HUD.Right.Quest.Container.Description

    for i, v in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
        if v:FindFirstChild("Units") then
            for i2, v2 in pairs(v.Units:GetChildren()) do
                if v2:FindFirstChild("Head") and v2.Head:FindFirstChild("Overhead") then
                    for i3, v3 in pairs(v2.Head.Overhead:GetChildren()) do
                        if v3.Name == "Name" and string.match(Quest.Text, v3.Text) then
                            local Mag = (Plr.CFrame.p - v3.Parent.Parent.Parent.HumanoidRootPart.CFrame.p).Magnitude
                            if Mag < Near then
                                TeleQuest = v3.Parent.Parent.Parent.HumanoidRootPart
                                Near = Mag
                            end
                        end
                    end
                end
            end
        end
    end
    return TeleQuest
end

QuestFarm:NewToggle("Auto Quest", "Does Quests Automatically For You", function(v)
getgenv().AutoQuest = v
    spawn(function()
        while wait() do
            if not AutoQuest then break; end
            pcall(function()
                Hrp = Player.Character.HumanoidRootPart
                ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateQuest:FireServer("StartQuest",ChooseZone)
                Hrp.CFrame = QuestTeleport().CFrame * CFrame.new(0,4,0) * CFrame.Angles((180),0,0)
                ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateMelee:FireServer("RequestAction","Combat","Combat")
                Noclip()
            end)
        end
    end)
end)

QuestFarm:NewDropdown("Choose Zone", "Choose Zone To AutoQuest", ZoneList, function(v)
    ChooseZone = v
    wait(1)
    ReplicatedStorage.Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(game:GetService("Workspace").Zones[v].CFrame,v)
end)

Other:NewToggle("Auto Collect Yen", "Collects Yen", function(v)
    getgenv().AutoYen = v
        spawn(function()
            while wait() do
                if not AutoYen then break; end
                for i, v in pairs(game:GetService("Workspace").Collectibles:GetChildren()) do
                Hrp = Player.Character.HumanoidRootPart
                v.CFrame = Hrp.CFrame
            end
        end
    end)
end)

Other:NewToggle("Auto Skill/Lock", "Uses Skills And Locks", function (v)
getgenv().AutoSkill = v
    while task.wait() do
        if not AutoSkill then break; end
        Vi:SendKeyEvent(true,"E",false,game)
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateAbilities:FireServer("Ability","1","Enter")
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateAbilities:FireServer("Ability","2","Enter")
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateAbilities:FireServer("Ability","3","Enter")
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateAbilities:FireServer("Ability","4","Enter")
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateAbilities:FireServer("Ability","5","Enter")
    end
end)

--Pets
local Pets = Window:NewTab("Pets")
local Eggs = Pets:NewSection("Eggs")

--Auto Eggs
Eggs:NewToggle("Start Egg Farm", "Starts The AutoFarm", function(v)
getgenv().AutoEgg = v
    while wait() do
    if not AutoEgg then break; end
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdatePets:FireServer("HatchEgg",ChooseEgg,"Multiple")
    end
end)

Eggs:NewDropdown("Choose Egg", "Choose The Egg To Hatch", EggList, function(v)
    ChooseEgg = v
end)

--Skills
local Skills = Window:NewTab("Skills")
local PickSkills = Skills:NewSection("Pick Skills")

PickSkills:NewToggle("Auto Buy Health", "Buys The Chosen Skill", function(v)
    getgenv().AutoHealth = v
        while wait() do
        if not AutoHealth then break; end
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateHeroes:FireServer("BuySkillLevel","Health",1)
    end
end)

PickSkills:NewToggle("Auto Buy Strength", "Buys The Chosen Skill", function(v)
    getgenv().AutoStrength = v
        while wait() do
        if not AutoStrength then break; end
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateHeroes:FireServer("BuySkillLevel","Strength",1)
    end
end)

PickSkills:NewToggle("Auto Buy Ability", "Buys The Chosen Skill", function(v)
    getgenv().AutoAbility = v
        while wait() do
        if not AutoAbility then break; end
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateHeroes:FireServer("BuySkillLevel","Ability",1)
    end
end)

PickSkills:NewToggle("Auto Buy Defense", "Buys The Chosen Skill", function(v)
    getgenv().AutoDefense = v
        while wait() do
        if not AutoDefense then break; end
        game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Events.Objects.UpdateHeroes:FireServer("BuySkillLevel","Defense",1)
    end
end)

--Misc
local Misc = Window:NewTab("Misc")
local Other = Misc:NewSection("Other")


Other:NewToggle("Disable Notifactions", "Disables Notifactions", function(v)
getgenv().DisableNoti = v
    if not DisableNoti then
        Noti.Visible = true;
    else
        Noti.Visible = false;
    end
end)

Other:NewToggle("Auto Buy New Hero", "Buys Other Heros", function(v)
    getgenv().AutoHero = v
    while wait() do
    if not AutoHero then break; end
        for i, v in pairs(ReplicatedStorage.Modules.ServiceLoader.EffectsService.Handlers.Heroes:GetChildren()) do
            ReplicatedStorage.Modules.ServiceLoader.NetworkService.Events.Objects.UpdateHeroes:FireServer("BuyHero",v.Name)
        end
    end
end)

--Teleports
local Teleports = Window:NewTab("Teleport")
local Worlds = Teleports:NewSection("Worlds")
local Npcs = Teleports:NewSection("Npcs")
local Bosses = Teleports:NewSection("Bosses")

Worlds:NewButton("Home", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(game:GetService("Workspace").Worlds.Home.Map.Path.Top.Union.CFrame + Vector3.new(0,5,0),"Home")
end)

Worlds:NewButton("Red Line", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(CFrame.new(Vector3.new(-115.82499694824219, -81.29000091552734, -1353.7120361328125), Vector3.new(-0, -0, -1)),"Red Line")
end)

Worlds:NewButton("Time Chamber", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(game:GetService("Workspace").Zones["Time Chamber"].CFrame + Vector3.new(58,-360,-50),"Time Chamber")
end)

Npcs:NewButton("Home Npc", "Teleport To Chosen Button", function()
    Hrp = Player.Character.HumanoidRootPart
    Hrp.CFrame = game:GetService("Workspace").Worlds.Home.Quest.Position.CFrame + Vector3.new(4,2,0)
end)

Npcs:NewButton("Red Line Npc", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(CFrame.new(Vector3.new(-115.82499694824219, -81.29000091552734, -1353.7120361328125), Vector3.new(-0, -0, -1)),"Red Line")
    Hrp = Player.Character.HumanoidRootPart
    Hrp.CFrame = game:GetService("Workspace").Worlds["Red Line"].Quest.Position.CFrame + Vector3.new(4,2,0)
end)

Bosses:NewButton("Home Boss", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(game:GetService("Workspace").Worlds.Home.Map.Path.Top.Union.CFrame + Vector3.new(0,5,0),"Home")
    Hrp = Player.Character.HumanoidRootPart
    Hrp.CFrame = game:GetService("Workspace").Worlds.Home.Extras.Boss.NotSpawned.CFrame + Vector3.new(0,2,0)
end)

Bosses:NewButton("Red Line Boss", "Teleport To Chosen Button", function()
    game:GetService("ReplicatedStorage").Modules.ServiceLoader.NetworkService.Functions.Objects.TeleportPlayer:InvokeServer(CFrame.new(Vector3.new(-115.82499694824219, -81.29000091552734, -1353.7120361328125), Vector3.new(-0, -0, -1)),"Red Line")
    Hrp = Player.Character.HumanoidRootPart
    Hrp.CFrame = game:GetService("Workspace").Worlds["Red Line"].Extras.Boss.NotSpawned.CFrame + Vector3.new(0,2,0)
end)

--Settings
local Settings = Window:NewTab("Settings")
local Themes = Settings:NewSection("Themes")
local Keybind = Settings:NewSection("Keybind")

--Themes
for Theme, Color in pairs(Colors) do
    Themes:NewColorPicker(Theme, "Change your "..Theme, Color, function(color3)
        Library:ChangeColor(Theme, color3)
    end)
end

--Keybinds
Keybind:NewKeybind("Ui Keybind", "Keybind To Open/Close Ui", Enum.KeyCode.RightShift, function()
	Library:ToggleUI()
end)
